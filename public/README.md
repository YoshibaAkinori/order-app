# 🍣 松栄寿司注文管理システム

年末年始などの繁忙期に特化した、Webベースの注文管理アプリケーションです。従来のExcelを使った電話・FAXによる注文管理をデジタル化し、複数人でのリアルタイムな情報共有、ミスの削減、業務の大幅な効率化を実現します。

## 📜 目次

- [✨ 主な機能](#主な機能)
- [⚠️ 注意事項](#注意事項)
- [🚀 アプリケーションの使い方](#アプリケーションの使い方)
  - [1. ログイン](#1-ログイン)
  - [2. 年度の選択](#2-年度の選択)
  - [3. 新規注文](#3-新規注文)
  - [4. 注文変更](#4-注文変更)
  - [5. 注文一覧](#5-注文一覧)
  - [6. 割振管理](#6-割振管理)
  - [7. 集計・管理機能](#7-集計管理機能)
  - [8. 設定管理](#8-設定管理)
- [📖 注文番号の見方](#注文番号の見方)
- [🤔 こんな時はどうするの？ (FAQ)](#こんな時はどうするの-faq)
- [🔧 使用技術](#使用技術)

---

## ✨ 主な機能

| 機能 | 概要 |
| :--- | :--- |
| 📅 **年度ごとのデータ管理** | 注文データや設定を年ごとに完全に分離し、安全に管理。 |
| ✍️ **リアルタイム注文管理** | 新規注文、注文内容の変更をWebフォームから直感的に入力。 |
| 🔢 **自動番号採番** | 受付番号・注文番号をルールに基づき注文時に自動で生成。 |
| 📋 **注文一覧** | 特定の日付や担当者ごとの注文状況を一覧で確認。 |
| 📄 **PDF注文確認書** | ワンクリックで注文確認書を生成・印刷。(FAX送信用) |
| 🚚 **割振管理** | 配達ルートごとの注文を可視化し、担当者を割り当て。 |
| 📊 **自動集計機能** | ネタ数や商品ごとの注文件数をリアルタイムで自動集計。 |
| ⚙️ **マスターデータ管理** | 商品メニュー、ネタの種類、配達先などのマスターデータをWeb上から簡単に編集。 |
| 📧 **メール通知** | 注文確定時にお客様へ自動で確認メールを送信。 最終確認メールも一覧から送信。|

---

## ⚠️ 注意事項

**ネタ変更や備考の修正を行うと、メールアドレスが登録されている注文には必ず通知メールが送信されます。**

意図しない通知を防ぐため、以下にご注意ください。
* 不用意な変更は避けてください。
* 注文内容の微調整は、一度Excelに出力してから行うことを推奨します。

---

## 🚀 アプリケーションの使い方

### 1. ログイン
アプリにアクセスすると、ログイン画面が表示されます。
![ログイン画面](/photo/Login.png)

### 2. 年度の選択
ログイン後、サイドバーの「年度選択」から操作したい年を選びます。ここで選択した年に基づいて、全てのデータが読み込まれます。
![年度選択画面](/photo/YearSelect.png)

### 3. 新規注文
サイドバーの「新規注文」から、新しい注文を入力します。
![新規注文Form](/photo/Order.png)

新規注文は、大きく分けて 

**「① 発注者情報の入力」「② 注文内容の登録」「③ お支払い情報の設定」「④ 注文確認書での確認・送信」** の4ステップで完了します。

---

#### **ステップ1：発注者様の情報を入力する**

まず、どなたからの注文かを明確にするため、発注者様の情報を入力します。

-   **担当者名、連絡先など**: 
    - 画面の指示に従って、項目を入力してください。
-   **住所、階数**:
    -   登録済みの住所リストから配達先を選択します。
    -   配達先に階数がある場合は入力してください。**階数がない、または不要な場合は空欄のままで問題ありません。**

---

#### **ステップ2：注文内容を登録する**

次に、ご注文の商品と数量を登録します。

1.  **商品の数量をまとめて入力**
    - まず、**ネタ変更やサビ抜きなども含めた、その商品の合計個数**を先に入力します。
    
    （例：極を合計5個注文し、そのうち1個がサビ抜きの場合でも、まず「5」と入力します）

2.  **ネタ変更やサビ抜きなどを設定**
    - 数量を入力後、**「ネタ変更・その他の注文」** というボタンが表示されます。これをクリックすると詳細設定画面が開き、特定の個数だけ「サビ抜き」にしたり、「折」に詰めたり、ネタを変更したりといった細かい指定が可能です。

3.  **お吸い物などの特別注文**
    - お寿司以外のサイドメニュー（お吸い物、お醤油など）は、**「その他のご注文」** の項目から追加してください。

---

#### **ステップ3：お支払い情報を設定する**

次に、お支払いの方法や領収書について設定します。

-   **基本的な領収書の発行**
    -   **「支払い方法」** と **「領収書の宛名」** を入力するだけで、注文全体の合計金額の領収書が自動で作成されます。

-   **支払いをまとめたい場合（合算支払い）**
    1.  **「まとめてお支払いの有無」** ボタンをクリックします。
    2.  「支払日を追加」ボタンを押し、**「どの注文の配達日に支払うか」** を選択します。
    3.  その日にまとめて支払いたい注文すべてにチェックを入れると、チェックした注文の合計金額で領収書が設定されます。

-   **領収書を分けたい・金額を指定したい場合**
    1.  **「領収書・請求書の詳細指定」** ボタンをクリックします。
    2.  「領収書/請求書を追加」ボタンを押し、必要な枚数だけ入力フォームを追加します。
    3.  それぞれのフォームで **「発行日」「宛名」「金額」** を自由に設定できます。

---

#### **ステップ4：注文確認書を開き、送信**

最後に、注文確認書を開き入力された情報と手元の注文用紙とで内容に違いがないかを確認してください。

- もし、ミスがあれば **修正** から入力を変更してください

- **送信** を押せば注文が登録されます。
- 注文が登録される際、メールアドレスが入力されていれば同時に確認メールも送信されます。
- メールアドレスが入力されておらずFAX番号のみある場合は、**印刷** ボタンから印刷しFAXを送信してください。

### 4. 注文変更
#### **方法1：「注文変更」ページから**
「注文変更」ページで受付番号を入力して検索すると、既存の注文を編集またはキャンセルできます。
![注文変更画面1](/photo/ChangeOrder1.png)

#### **方法2：「注文一覧」ページから**
「注文一覧」ページで注文番号をクリックすると、その注文を直接編集またはキャンセルできます。
![注文変更画面2](/photo/ChangeOrder2.png)



### 5. 注文一覧
「注文一覧」では、日付や担当者で注文を絞り込み、一覧で確認できます。
* **PDF出力**: 各注文の右側にあるPDFボタンを押すと、印刷可能な注文確認書が新しいタブで開きます。
* **メールアドレス警告**: お客様情報にメールアドレスが登録されていない注文は、PDFボタンが赤枠で表示されます。
![注文一覧](/photo/Dashboard.png)

### 6. 割振管理
「割振管理」ページでは、特定の日付の注文を建物の階層ごとにグループ化して表示します。各注文に配達担当者を割り当て、「割振決定 更新」ボタンで保存します。
![割振管理](./photo/Allocation.png)

### 7. 集計・管理機能
#### **ネタ数集計**
指定した日付と担当者で、必要なネタの総数を商品別・ネタ別に自動集計します。ネタ数の部分をクリックすると詳細が表示されます。
![ネタ数集計](./photo/CountNeta.png)

#### **ネタ変更管理**
ネタ変更が行われた注文を一覧で確認し、変更内容を管理します。
![ネタ変更](./photo/ChangeNeta.png)

### 8. 設定管理
「設定管理」ページでは、システムの動作に必要な各種マスターデータを編集します。
* **年度更新**: 新しい年のデータが存在しない場合、前年の設定をコピーして年度更新を行うボタンが表示されます。
![設定管理](/photo/Setting1.png)
* **詳細設定**: 各カードをクリックすると、詳細設定画面が開きます。
![設定管理](/photo/Setting2.png)

---

## 📖 注文番号の見方

### 注文番号
「いつ」「どこから」「何番目」の注文かが一目でわかるように作られた、便利な6桁の番号です。

`[日付 (2桁)]` + `[受付番号 (3桁)]` + `[通し番号 (1桁)]`

### 受付番号 ([中央の3桁])
注文元の場所（建物・階数・部署）を特定するための番号です。

`[建物の記号]` + `[階数]` + `[部署の記号]`

建物の記号 (1文字目): どの建物・部署グループからの注文かを示します。（例：A → 県庁）

※各記号がどの場所に対応するかは、設定画面の「割り当て番号管理」で確認できます。

階数 (2文字目): その部署がある建物の階数がそのまま入ります。（例：7 → 7階）

部署の記号 (3文字目): 同じ階にある複数の部署を区別するための記号です。（例：A）
###

**例：`27A7A1`**
* `27` → 12月**27**日の注文
* `A7A` → **県庁7階のA部署**からの注文
* `1` → その場所での、その日**1番目**の注文各パーツの詳しい見方




---

## 🤔 こんな時はどうするの？ (FAQ)

<details>
  <summary><strong>1. 追加したい特別注文がない時</strong></summary>

  1. 設定画面から、特殊メニュー管理を選択します。

  2. 「追加」ボタンを押すと、新しい商品の詳細を追加出来ます。

  3. 商品の詳細欄で、`[名前]`・`[金額]`・`[入れるネタ]`を追加してください。
</details>

<details>
  <summary><strong>2. 別の日にちの注文を追加したい</strong></summary>
  
  1. 設定画面から、配達日管理を選択します。

  2. 「追加」ボタンを押すと、新しい配達日を`[追加]`・`[編集]`出来ます。
</details>

<details>
  <summary><strong>3. メールを送信したい</strong></summary>

  # 注意　メールは一度送信をしていないと送信できません。

  自分で宛先を決めて送信する事はできません。返信・追加送信しか出来ません。

  1. ヘッダーのメールボックスを開きます。

  2. 受信トレイの中の`[送信済み]`・`[最終確認]`欄から送りたい相手を選びます。

  3. 入力欄に送りたい文字を入力し、送信を押してください。
</details>

<details>
  <summary><strong>4. 使いたいネタが見つからない　新しいネタの登録の仕方</strong></summary>
  新しい商品を登録する際に使いたいネタがないことが考えられます。

  1. 設定画面からネタ種類管理を選択します。

  2. 新しいネタを追加から、使いたいネタを登録してください。

  3. 追加する際に、カテゴリを入力する必要があります。
  
  4. 集計の際に使うので使うネタが`[シャリ玉]`・`[海苔巻き玉]`など考えて入力してください。
</details>

#

---

## 🔧 使用技術

* **フロントエンド**: Next.js (React), Tailwind CSS
* **バックエンド**: AWS Lambda (Node.js, Python)
* **データベース**: AWS DynamoDB
* **認証**: AWS Cognito
* **メール送信**: AWS SES
* **ホスティング**: Vercel (フロントエンド), AWS (バックエンド)